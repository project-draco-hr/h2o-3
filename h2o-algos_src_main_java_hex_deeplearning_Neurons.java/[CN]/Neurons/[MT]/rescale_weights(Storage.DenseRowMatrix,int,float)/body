{
  final int cols=_previous._a.size();
  final int start=linearIndexMatrix(row,0,cols);
  final int end=linearIndexMatrix(row,w.cols(),cols);
  float r2=MathUtils.sumSquares(w.raw(),start,end);
  if (r2 > max_w2) {
    final float scale=MathUtils.approxSqrt(max_w2 / r2);
    for (int c=start; c < end; c++)     w.raw()[c]*=scale;
  }
}
