{
  gemv(_a,_w,_previous._a,_b,null);
  final double max=ArrayUtils.maxValue(_a.raw());
  double scaling=0;
  final int rows=_a.size();
  for (int row=0; row < rows; row++) {
    _a.set(row,Math.exp(_a.get(row) - max));
    scaling+=_a.get(row);
  }
  scaling=1. / scaling;
  for (int row=0; row < rows; row++) {
    _a.raw()[row]*=scaling;
  }
}
