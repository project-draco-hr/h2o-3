{
  _wcount+=weight;
  ++_nobs;
  if (_parms._family == Family.multinomial) {
    residual_deviance+=ymodel;
    null_deviance+=yreal;
  }
 else {
    residual_deviance+=weight * _parms.deviance(yreal,ymodel);
    double ynull=offset == 0 ? _ymu : _parms.linkInv(offset + _ymuLink);
    null_deviance+=weight * _parms.deviance(yreal,ynull);
    if (_parms._family == Family.poisson) {
      long y=Math.round(yreal);
      double logfactorial=0;
      for (long i=2; i <= y; ++i)       logfactorial+=Math.log(i);
      _aic2+=weight * (yreal * Math.log(ymodel) - logfactorial - ymodel);
    }
  }
}
