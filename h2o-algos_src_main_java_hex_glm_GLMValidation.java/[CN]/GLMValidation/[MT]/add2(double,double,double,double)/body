{
  residual_deviance+=weight * _glm.deviance(yreal,ymodel);
  double ynull=offset == 0 ? _ymu : _glm.linkInv(offset);
  null_deviance+=weight * _glm.deviance(yreal,ynull);
  ++nobs;
  if (_glm._family == Family.poisson) {
    long y=Math.round(yreal);
    double logfactorial=0;
    for (long i=2; i <= y; ++i)     logfactorial+=Math.log(i);
    _aic2+=weight + (yreal * Math.log(ymodel) - logfactorial - ymodel);
  }
}
