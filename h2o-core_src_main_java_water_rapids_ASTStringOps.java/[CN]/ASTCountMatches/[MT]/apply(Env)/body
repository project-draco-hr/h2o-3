{
  Frame fr=env.popAry();
  if (fr.numCols() != 1)   throw new IllegalArgumentException("countmatches requires a single column.");
  if (!fr.anyVec().isEnum())   throw new IllegalArgumentException("countmatches column must be categorical. Got: " + fr.anyVec().get_type_str());
  final int[] matchCounts=countMatches(fr.anyVec().domain());
  Frame fr2=new MRTask(){
    @Override public void map(    Chunk c,    NewChunk nc){
      for (int i=0; i < c._len; ++i)       if (c.isNA(i))       nc.addNA();
 else       nc.addNum(matchCounts[(int)c.at8(i)],0);
    }
  }
.doAll(1,fr).outputFrame();
  env.pushAry(fr2);
}
