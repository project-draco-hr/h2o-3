{
  if (_nobs > 0) {
    InitTsk.this.addToPendingCount(1);
    if (_parms._family == Family.multinomial) {
      final double[][] beta=new double[nclasses()][];
      for (int i=0; i < beta.length; ++i) {
        beta[i]=MemoryManager.malloc8d(_dinfo.fullN() + 1);
        beta[i][_dinfo.fullN()]=Math.log(_yMu[i]);
      }
      _gtNullMultinomial=new GLMMultinomialGradientTask(_dinfo,0,_yMu,beta,_parms._obj_reg,true,InitTsk.this).dfork(_dinfo._adaptedFrame);
      if (_validDinfo != null) {
        InitTsk.this.addToPendingCount(1);
        _gtNullTestMultinomial=new GLMMultinomialGradientTask(_validDinfo,0,_yMu,beta,1.0,true,InitTsk.this).dfork(_validDinfo._adaptedFrame);
      }
    }
 else {
      final double[] beta=MemoryManager.malloc8d(_dinfo.fullN() + 1);
      if (_intercept) {
        beta[beta.length - 1]=_ymuLink;
      }
      if (_bc._betaStart == null)       _bc.setBetaStart(beta);
      _gtNull=new GLMGradientTask(_dinfo,_parms,0,beta,_parms._obj_reg,_parms._intercept,InitTsk.this).setValidate(_yMu[0],true).dfork(_dinfo._adaptedFrame);
      if (_validDinfo != null) {
        InitTsk.this.addToPendingCount(1);
        _gtNullTest=new GLMGradientTask(_validDinfo,_parms,0,beta,1.0,_parms._intercept,InitTsk.this).setValidate(_yMu[0],true).dfork(_validDinfo._adaptedFrame);
      }
      if (beta != _bc._betaStart) {
        InitTsk.this.addToPendingCount(1);
        _gtBetaStart=new GLMGradientTask(_dinfo,_parms,0,_bc._betaStart,_parms._obj_reg,_parms._intercept,InitTsk.this).setValidate(_yMu[0],true).dfork(_dinfo._adaptedFrame);
      }
    }
  }
}
