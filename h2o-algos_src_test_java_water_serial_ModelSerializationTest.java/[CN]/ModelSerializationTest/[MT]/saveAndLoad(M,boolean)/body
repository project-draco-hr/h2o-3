{
  File file=com.google.common.io.Files.createTempDir();
  try {
    java.net.URI uri=file.toURI();
    List<Key> modelKeys=new LinkedList<>();
    modelKeys.add(model._key);
    modelKeys.addAll(model.getPublishedKeys());
    ObjectTreeBinarySerializer serializer=new ObjectTreeBinarySerializer();
    serializer.save(modelKeys,uri);
    if (deleteModel)     model.delete();
    for (    Key k : modelKeys) {
      if (k != null)       Assert.assertNull(DKV.get(k));
    }
    List<Key> loadedModelKeys=serializer.load(uri);
    Assert.assertEquals("Number of saved and loaded keys has to be equal",modelKeys.size(),loadedModelKeys.size());
    for (int i=0; i < modelKeys.size(); i++) {
      Assert.assertEquals("Saved and loaded keys has to match",modelKeys.get(i),loadedModelKeys.get(i));
    }
    M m=(M)loadedModelKeys.get(0).get();
    return m;
  }
  finally {
    FileUtils.delete(file);
  }
}
