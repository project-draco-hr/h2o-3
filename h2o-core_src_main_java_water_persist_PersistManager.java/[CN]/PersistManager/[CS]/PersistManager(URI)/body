{
  I=new Persist[8];
  storeCount=new AtomicLong();
  deleteCount=new AtomicLong();
  loadCount=new AtomicLong();
  Persist ice=null;
  URI uri=iceRoot;
  if (uri != null) {
    boolean windowsPath=uri.toString().matches("^[a-zA-Z]:.*");
    if (windowsPath) {
      ice=new PersistFS(new File(uri.toString()));
    }
 else     if ((uri.getScheme() == null) || Schemes.FILE.equals(uri.getScheme())) {
      ice=new PersistFS(new File(uri.getPath()));
    }
 else     if (Schemes.HDFS.equals(uri.getScheme())) {
      ice=new PersistHdfs(uri);
    }
    I[Value.ICE]=ice;
    I[Value.NFS]=new PersistNFS();
    try {
      I[Value.HDFS]=new PersistHdfs();
      I[Value.S3]=new PersistS3();
    }
 catch (    NoClassDefFoundError e) {
    }
  }
}
