def run_test(sys_args, test_to_run):
    (ip, port) = sys_args[2].split(':')
    init(ip, port)
    log_and_echo('------------------------------------------------------------')
    log_and_echo('')
    log_and_echo(('STARTING TEST: ' + str(ou())))
    log_and_echo('')
    log_and_echo('------------------------------------------------------------')
    num_keys = store_size()
    try:
        test_to_run(ip, port)
    finally:
        remove_all()
        if keys_leaked(num_keys):
            print 'Leaked Keys!'
