{
  if (x == null)   return null;
  if (x.length != x[0].length)   throw new IllegalArgumentException("x must be a symmetric matrix!");
  int len=x.length;
  double[] diag=new double[len];
  if (gamma == 0)   return diag;
  for (int i=0; i < len; i++) {
    x[i][i]+=gamma;
    diag[i]=gamma;
  }
  return diag;
}
