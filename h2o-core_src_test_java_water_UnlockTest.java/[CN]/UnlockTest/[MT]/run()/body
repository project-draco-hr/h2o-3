{
  Frame f=new TestUtil().parse_test_file("smalldata/junit/syn_2659x1049.csv.gz");
  Frame fr1=new Frame(Key.make(),f.names(),f.vecs());
  Frame fr2=new Frame(Key.make(),f.names(),f.vecs());
  DJob dj=new DJob(Key.make());
  fr1.delete_and_lock(dj._key);
  fr2.delete_and_lock(dj._key);
  int i=0;
  try {
    fr1.delete();
    fr2.delete();
  }
 catch (  Throwable t) {
    Log.info("Correctly caught exception: " + t.getClass());
    i++;
  }
 finally {
    new UnlockTask().doAllNodes();
    fr1.delete();
    fr2.delete();
    f.delete();
    Log.info("Able to delete after unlocking.");
  }
  Assert.assertTrue(i == 1);
}
