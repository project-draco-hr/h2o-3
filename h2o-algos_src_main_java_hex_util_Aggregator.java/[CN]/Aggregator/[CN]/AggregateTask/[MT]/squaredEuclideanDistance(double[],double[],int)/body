{
  double sum=0;
  int n=0;
  for (int j=0; j < nCols; j++) {
    double d1=e1[j];
    double d2=e2[j];
    if (!isMissing(d1) && !isMissing(d2)) {
      sum+=(d1 - d2) * (d1 - d2);
      n++;
    }
  }
  sum*=(double)nCols / n;
  return sum;
}
