{
  closeLocal();
  if (_doProfile)   _profile._closeLocalDone=System.currentTimeMillis();
  reduce3(_nleft);
  reduce3(_nrite);
  if (_doProfile)   _profile._remoteBlkDone=System.currentTimeMillis();
  _fs.blockForPending();
  if (_doProfile)   _profile._localBlkDone=System.currentTimeMillis();
  int nlo=subShift(selfidx());
  int nhi=_nhi;
  if (_res == null)   _nhi=-1;
 else   if (_res != this) {
    _res._profile=_profile;
    copyOver(_res);
  }
  if (_topGlobal) {
    if (_fr != null)     _fr.postWrite(_fs).blockForPending();
    postGlobal();
  }
}
