{
  ExampleModel model=null;
  try {
    Scope.enter();
    _parms.read_lock_frames(Example.this);
    init(true);
    model=new ExampleModel(dest(),_parms,new ExampleModel.ExampleOutput(Example.this));
    model.delete_and_lock(_key);
    for (; model._output._iterations < _parms._max_iterations; model._output._iterations++) {
      if (!isRunning())       break;
      double[] maxs=new Max().doAll(_parms.train())._maxs;
      model._output._maxs=maxs;
      model.update(_key);
      update(1);
      StringBuilder sb=new StringBuilder();
      sb.append("Example: iter: ").append(model._output._iterations);
      Log.info(sb);
    }
    done();
  }
 catch (  Throwable t) {
    if (_state == JobState.CANCELLED) {
      Log.info("Job cancelled by user.");
    }
 else {
      t.printStackTrace();
      failed(t);
      throw t;
    }
  }
 finally {
    updateModelOutput();
    if (model != null)     model.unlock(_key);
    _parms.read_unlock_frames(Example.this);
    Scope.exit(model._key);
  }
  tryComplete();
}
