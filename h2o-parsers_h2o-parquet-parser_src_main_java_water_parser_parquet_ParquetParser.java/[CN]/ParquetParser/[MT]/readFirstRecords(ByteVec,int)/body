{
  ParquetMetadata metadata=VecParquetReader.readFooter(vec,ParquetMetadataConverter.NO_FILTER);
  ParquetMetadata startMetadata=new ParquetMetadata(metadata.getFileMetaData(),Collections.singletonList(findFirstBlock(metadata)));
  VecParquetReader reader=new VecParquetReader(vec,startMetadata);
  List<GenericRecord> records=new ArrayList<>(cnt);
  try {
    GenericRecord record;
    while ((records.size() < cnt) && ((record=reader.read()) != null)) {
      records.add(record);
    }
  }
 catch (  IOException e) {
    throw new RuntimeException("Failed to read the first few records",e);
  }
  return records;
}
