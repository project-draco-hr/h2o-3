{
  _vg=vg;
  _setup=setup;
  _vecIdStart=_vg.reserveKeys(_setup._pType == ParserType.SVMLight ? 100000000 : setup._ncols);
  _delete_on_done=delete_on_done;
  _job_key=job_key;
  _fileChunkOffsets=new int[fkeys.length];
  int len=0, totalParseSize=0;
  ByteVec bv;
  float dcr, maxDecomprRatio=0;
  for (int i=0; i < fkeys.length; ++i) {
    _fileChunkOffsets[i]=len;
    bv=getByteVec(fkeys[i]);
    len+=bv.nChunks();
    dcr=ZipUtil.decompressionRatio(bv);
    if (dcr > maxDecomprRatio)     maxDecomprRatio=dcr;
    totalParseSize+=bv.length();
  }
  totalParseSize=(int)(totalParseSize * maxDecomprRatio);
  _setup._chunkSize=Vec.calcOptimalChunkSize(totalParseSize,_setup._ncols);
  _chunk2Enum=MemoryManager.malloc4(len);
  Arrays.fill(_chunk2Enum,-1);
}
