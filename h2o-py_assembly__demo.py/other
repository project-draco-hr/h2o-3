import h2o
from h2o import H2OAssembly
from h2o.transforms.preprocessing import *
from h2o import H2OFrame
h2o.init()
fr = h2o.import_file(h2o.locate('smalldata/iris/iris_wheader.csv'))
assembly = H2OAssembly(steps=[('col_select', H2OColSelect(['sepal_len', 'petal_len', 'class'])), ('cos_sep_len', H2OColOp(fun=H2OFrame.cos, col='sepal_len', append=False)), ('str_cnt_species', H2OColOp(fun=H2OFrame.countmatches, col='class', append=True, pattern='s'))])
result = assembly.fit(fr)
result.show()
print assembly.to_pojo(pojo_name='GeneratedH2OMungingPojo_001')
