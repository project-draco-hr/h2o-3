{
  DRFModel.DRFParameters drf=new DRFModel.DRFParameters();
  Key destTrain=Key.make(hexnametrain);
  Key destTest=hexnametest != null ? Key.make(hexnametest) : null;
  Frame frTest=null, pred=null;
  Frame frTrain=null;
  DRFModel model=null;
  try {
    frTrain=parse_test_file(fnametrain);
    unifyFrame(drf,frTrain,prep);
    drf._train=frTrain._key;
    drf._response_column=((Frame)DKV.getGet(drf._train)).lastVecName();
    drf._convert_to_enum=true;
    drf._ntrees=ntree;
    drf._max_depth=max_depth;
    drf._min_rows=1;
    drf._nbins=nbins;
    drf._mtries=-1;
    drf._sample_rate=0.66667f;
    drf._seed=(1L << 32) | 2;
    drf._destination_key=Key.make("DRF_model_4_" + hexnametrain);
    DRF job=null;
    try {
      job=new DRF(drf);
      model=job.trainModel().get();
    }
  finally {
      if (job != null)       job.remove();
    }
    frTest=fnametest != null ? parse_test_file(fnametest) : null;
    pred=model.score(frTest);
  }
  finally {
    if (frTrain != null)     frTrain.remove();
    if (frTest != null)     frTest.remove();
    if (model != null)     model.delete();
    if (pred != null)     pred.delete();
  }
}
