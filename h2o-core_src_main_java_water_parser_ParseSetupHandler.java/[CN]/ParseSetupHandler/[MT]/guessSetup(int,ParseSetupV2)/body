{
  Key[] fkeys=new Key[p.srcs.length];
  for (int i=0; i < p.srcs.length; i++) {
    fkeys[i]=p.srcs[i].key();
    if (DKV.get(fkeys[i]) == null)     throw new IllegalArgumentException("Key not loaded: " + p.srcs[i]);
  }
  ParseSetup ps=ParseSetup.guessSetup(fkeys,new ParseSetup(p.singleQuotes,p.checkHeader));
  PojoUtils.copyProperties(p,ps,PojoUtils.FieldNaming.ORIGIN_HAS_UNDERSCORES,new String[]{"hex","srcs"});
  p.hexName=ParseSetup.hex(p.srcs[0].toString());
  if (p.checkHeader == 1)   p.data=Arrays.copyOfRange(p.data,1,p.data.length - 1);
  if (ps._ctypes != null) {
    p.columnDataTypes=new String[ps._ctypes.length];
    for (int i=0; i < ps._ctypes.length; i++) {
      p.columnDataTypes[i]=ps._ctypes[i].toString();
    }
  }
  return p;
}
