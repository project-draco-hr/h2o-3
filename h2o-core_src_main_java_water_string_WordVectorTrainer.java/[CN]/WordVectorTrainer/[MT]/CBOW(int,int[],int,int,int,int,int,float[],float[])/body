{
  int winWordSentIdx, winWord;
  if (_normModel == NormModel.NegSampling) {
    for (int i=0; i < _wordVecSize; i++)     neu1[i]/=bagSize;
    negSamplingCBOW(curWord,0,neu1,neu1e);
  }
 else   hierarchicalSoftmaxCBOW(curWord,neu1,neu1e);
  for (int winIdx=winSizeMod; winIdx < _windowSize * 2 + 1 - winSizeMod; winIdx++) {
    if (winIdx != _windowSize) {
      winWordSentIdx=sentIdx - _windowSize + winIdx;
      if (winWordSentIdx < 0)       continue;
      if (winWordSentIdx >= sentLen)       continue;
      winWord=sentence[winWordSentIdx];
      for (int i=0; i < _wordVecSize; i++)       _syn0[i + winWord * _wordVecSize]+=neu1e[i];
    }
  }
}
