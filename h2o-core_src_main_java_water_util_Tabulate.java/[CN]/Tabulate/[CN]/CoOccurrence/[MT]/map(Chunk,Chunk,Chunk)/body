{
  for (int r=0; r < x.len(); ++r) {
    int xbin=_sp.bin(x.vec(),x.atd(r));
    int ybin=_sp.bin(y.vec(),y.atd(r));
    double weight=w.atd(r);
    if (Double.isNaN(weight))     continue;
    AtomicUtils.DoubleArray.add(_sp._count_data[xbin],ybin,weight);
    if (!y.isNA(r)) {
      AtomicUtils.DoubleArray.add(_sp._response_data[xbin],0,weight * y.atd(r));
      AtomicUtils.DoubleArray.add(_sp._response_data[xbin],1,weight);
    }
  }
}
