{
  int missing=v.naCnt() > 0 ? 1 : 0;
  if (Double.isNaN(val)) {
    assert(missing == 1);
    return 0;
  }
  int b;
  int bins=bins(Arrays.equals(v._key._kb,_respVec._kb));
  if (v.isEnum()) {
    assert((int)val == val);
    b=(int)val;
  }
 else {
    double d=(v.max() - v.min()) / bins;
    b=(int)((val - v.min()) / d);
    assert(b >= 0 && b <= bins);
    b=Math.min(b,bins - 1);
  }
  return b + missing;
}
