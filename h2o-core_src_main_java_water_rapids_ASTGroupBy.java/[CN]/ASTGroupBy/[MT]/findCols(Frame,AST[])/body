{
  long[] res=new long[asts.length];
  int i=0;
  for (  AST ast : asts) {
    Env e=treeWalk(new Env(new HashSet<Key>()));
    if (e.isAry())     res[i++]=f.find(e.popAry().anyVec());
 else     if (e.isNum())     res[i++]=(int)e.popDbl();
 else     if (e.isStr())     res[i++]=f.find(e.popStr());
 else     throw new IllegalArgumentException("Don't know what to do with: " + ast.getClass() + "; "+ e.pop());
  }
  return res;
}
