def offset_gamma():
    insurance = h2o.import_file(pyunit_utils.locate('smalldata/glm_test/insurance.csv'))
    insurance['offset'] = insurance['Holders'].log()
    gbm = H2OGradientBoostingEstimator(distribution='gamma', ntrees=600, max_depth=1, min_rows=1, learn_rate=0.1)
    gbm.train(x=list(range(3)), y='Claims', training_frame=insurance, offset_column='offset')
    predictions = gbm.predict(insurance)
    assert (abs(((-1.714958) - gbm._model_json['output']['init_f'])) < 1e-05), 'expected init_f to be {0}, but got {1}'.format((-1.714958), gbm._model_json['output']['init_f'])
    assert (abs((50.1087 - predictions.mean()[0])) < 0.01), 'expected prediction mean to be {0}, but got {1}'.format(50.1087, predictions.mean()[0])
    assert (abs((0.9133843 - predictions.min())) < 0.0001), 'expected prediction min to be {0}, but got {1}'.format(0.9133843, predictions.min())
    assert (abs((392.6667 - predictions.max())) < 0.1), 'expected prediction max to be {0}, but got {1}'.format(392.6667, predictions.max())
