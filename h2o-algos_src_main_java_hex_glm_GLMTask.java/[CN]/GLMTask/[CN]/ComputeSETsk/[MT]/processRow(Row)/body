{
  double z=r.response(0);
  double w=r.weight;
  if (_parms._family != Family.gaussian) {
    double etaOld=r.innerProduct(_betaNew) + _sparseOffsetNew;
    _glmw.compute(etaOld,r.response(0),r.weight,r.offset);
    z=_glmw.z;
    w=_glmw.w;
  }
  double eta=r.innerProduct(_betaNew) + _sparseOffsetNew;
  _sumsqe+=w * (eta - z) * (eta - z);
  _wsum+=Math.sqrt(w);
}
