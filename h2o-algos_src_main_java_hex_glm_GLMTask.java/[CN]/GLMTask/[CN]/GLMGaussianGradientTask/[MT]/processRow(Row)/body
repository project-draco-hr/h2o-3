{
  double[] g=_gradient;
  double[] b=_beta;
  double y=row.response(0);
  double eta=row.innerProduct(b) + _sparseOffset + row.offset;
  double diff=y - eta;
  _likelihood+=row.weight * diff * diff;
  double gval=row.weight * (eta - y);
  for (int i=0; i < row.nBins; ++i)   g[row.binIds[i]]+=gval;
  int off=_dinfo.numStart();
  for (int j=0; j < row.nNums; ++j)   _gradient[(row.numIds == null ? j + off : row.numIds[j])]+=row.numVals[j] * gval;
  g[g.length - 1]+=gval;
}
