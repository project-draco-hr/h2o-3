{
  Chunk yChunk=chks[0];
  Chunk zChunk=chks[1];
  Chunk wChunk=chks[2];
  Chunk eChunk=chks[3];
  for (int i=0; i < yChunk._len; ++i) {
    double y=yChunk.atd(i);
    double eta=eChunk.atd(i);
    double mu=_params.linkInv(eta);
    double var=Math.max(1e-6,_params.variance(mu));
    double d=_params.linkDeriv(mu);
    zChunk.set(i,eta + (y - mu) * d);
    wChunk.set(i,1.0 / (var * d * d));
  }
}
