{
  int rank=0;
  for (int i=0; i < _beta.length; ++i)   if (_beta[i] != 0)   ++rank;
  _gradient=MemoryManager.malloc8d(_beta.length);
  String[] domain=_dinfo._adaptedFrame.lastVec().domain();
  if (domain == null && _params._family == Family.binomial)   domain=new String[]{"0","1"};
  _val=new GLMValidation(domain,new double[]{_ymu},_params,rank,0,_validate,_intercept);
  boolean[] skp=MemoryManager.mallocZ(chks[0]._len);
  if (_forceCols || (!_forceRows && (chks.length >= 100 || mostlySparse(chks))))   goByCols(chks,skp);
 else   goByRows(chks,skp);
}
