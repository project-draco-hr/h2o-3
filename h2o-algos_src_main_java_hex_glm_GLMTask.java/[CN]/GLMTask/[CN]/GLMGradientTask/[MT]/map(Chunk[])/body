{
  int rank=0;
  for (int i=0; i < _beta.length; ++i)   if (_beta[i] != 0)   ++rank;
  if (_validate) {
    String[] domain=_dinfo._adaptedFrame.lastVec().domain();
    if (domain == null && _params._family == Family.binomial)     domain=new String[]{"0","1"};
    _val=new GLMValidation(domain,_ymu,_params,rank,.5);
  }
  _gradient=MemoryManager.malloc8d(_beta.length);
  boolean[] skp=MemoryManager.mallocZ(chks[0]._len);
  if (_rowFilter != null) {
    Chunk c=_rowFilter.chunkForChunkIdx(chks[0].cidx());
    for (int r=0; r < chks[0]._len; ++r)     skp[r]=c.at8(r) == 1;
  }
  if (_forceCols || (!_forceRows && (chks.length >= 100 || mostlySparse(chks))))   goByCols(chks,skp);
 else   goByRows(chks,skp);
}
