{
  ArrayList<Double> dbls=new ArrayList<>();
  ArrayList<ASTSpan> spans=new ArrayList<>();
  ArrayList<Long> cnts=new ArrayList<>();
  long cnt=0;
  AST a;
  while (!E.isEnd()) {
    a=E.parse();
    if (a instanceof ASTDoubleList) {
      cnt+=addAll(dbls,((ASTDoubleList)a)._d);
    }
 else     if (a instanceof ASTNum) {
      dbls.add(((ASTNum)a)._d);
      cnt++;
    }
 else     if (a instanceof ASTSpan) {
      spans.add((ASTSpan)a);
      cnts.add(cnt);
      cnt=0;
      cnts.add(cnt);
    }
 else     throw new IllegalArgumentException("'c' expected a dlist, a number, or a span. Got: " + a.getClass());
  }
  cnts.add(cnt);
  _tilNext=new long[cnts.size()];
  int i=0;
  for (  long l : cnts)   _tilNext[i++]=l;
  ASTSeries s=new ASTSeries(null,toArray(dbls),spans.toArray(new ASTSpan[spans.size()]));
  E.eatEnd();
  ASTCat res=(ASTCat)clone();
  res._asts=new AST[]{s};
  return res;
}
