{
  if (sigma != 0) {
    ConfusionMatrix cm=new ConfusionMatrix(_cm,_domain);
    float[] hr=new float[_K];
    double mse=Double.NaN;
    double logloss=Double.NaN;
    if (_count != 0) {
      if (_hits != null) {
        for (int i=0; i < hr.length; i++)         hr[i]=(float)_hits[i] / _count;
        for (int i=1; i < hr.length; i++)         hr[i]+=hr[i - 1];
      }
      mse=_sumsqe / _wsum;
      logloss=_logloss / _wsum;
    }
    return m._output.addModelMetrics(new ModelMetricsMultinomial(m,f,mse,_domain,sigma,cm,hr,logloss));
  }
 else {
    return m._output.addModelMetrics(new ModelMetricsMultinomial(m,f,Double.NaN,null,Double.NaN,null,null,Double.NaN));
  }
}
