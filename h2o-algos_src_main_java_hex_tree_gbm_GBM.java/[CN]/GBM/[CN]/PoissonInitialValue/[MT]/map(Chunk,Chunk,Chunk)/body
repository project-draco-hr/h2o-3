{
  for (int i=0; i < response._len; ++i) {
    if (response.isNA(i))     continue;
    double w=weight.atd(i);
    if (w == 0)     continue;
    _num+=w * response.atd(i);
    _denom+=w * Math.max(1e-19,Math.min(1e19,Math.exp(offset.atd(i))));
  }
}
