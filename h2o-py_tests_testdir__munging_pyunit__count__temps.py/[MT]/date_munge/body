def date_munge():
    crimes_path = pyunit_utils.locate('smalldata/chicago/chicagoCrimes10k.csv.zip')
    tmps0 = pyunit_utils.temp_ctr()
    rest0 = pyunit_utils.rest_ctr()
    crimes = h2o.import_file(path=crimes_path)
    crimes['Date'] = crimes['Date'].as_date('%m/%d/%Y %I:%M:%S %p')
    crimes['Day'] = crimes['Date'].day()
    crimes['Month'] = (crimes['Date'].month() + 1)
    crimes['Year'] = (crimes['Date'].year() + 1900)
    crimes['WeekNum'] = crimes['Date'].week()
    crimes['WeekDay'] = crimes['Date'].dayOfWeek()
    crimes['HourOfDay'] = crimes['Date'].hour()
    crimes['Weekend'] = ((crimes['WeekDay'] == 'Sun') | (crimes['WeekDay'] == 'Sat'))
    crimes['Season'] = crimes['Month'].cut([0, 2, 5, 7, 10, 12], ['Winter', 'Spring', 'Summer', 'Autumn', 'Winter'])
    crimes = crimes.drop('Date')
    crimes.describe()
    tmps1 = pyunit_utils.temp_ctr()
    ntmps = (tmps1 - tmps0)
    rest1 = pyunit_utils.rest_ctr()
    nrest = (rest1 - rest0)
    print(('Number of temps used: ', ntmps))
    print(('Number of RESTs used: ', nrest))
    assert (ntmps <= 15)
    assert (nrest <= 20)
