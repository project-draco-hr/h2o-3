def date_munge():
    crimes_path = pyunit_utils.locate('smalldata/chicago/chicagoCrimes10k.csv.zip')
    hc = h2o.connection()
    tmps0 = pyunit_utils.temp_ctr()
    crimes = h2o.import_file(path=crimes_path, destination_frame='crimes')
    rest1 = hc.requests_count
    crimes['Day'] = crimes['Date'].day()
    crimes['Month'] = (crimes['Date'].month() + 1)
    crimes['Year'] = (crimes['Date'].year() + 1900)
    crimes['WeekNum'] = crimes['Date'].week()
    crimes['WeekDay'] = crimes['Date'].dayOfWeek()
    crimes['HourOfDay'] = crimes['Date'].hour()
    print(('# of REST calls used: %d' % (hc.requests_count - rest1)))
    crimes['Weekend'] = ((crimes['WeekDay'] == 'Sun') | (crimes['WeekDay'] == 'Sat'))
    print(('# of REST calls used: %d' % (hc.requests_count - rest1)))
    crimes['Season'] = crimes['Month'].cut([0, 2, 5, 7, 10, 12], ['Winter', 'Spring', 'Summer', 'Autumn', 'Winter'])
    print(('# of REST calls used: %d' % (hc.requests_count - rest1)))
    crimes = crimes.drop('Date')
    print(('# of REST calls used: %d' % (hc.requests_count - rest1)))
    crimes.describe()
    print(('# of REST calls used: %d' % (hc.requests_count - rest1)))
    ntmps = (pyunit_utils.temp_ctr() - tmps0)
    nrest = (pyunit_utils.rest_ctr() - rest1)
    print(('Number of temps used: %d' % ntmps))
    print(('Number of RESTs used: %d' % nrest))
    assert (ntmps == 8)
    assert (nrest == 3)
