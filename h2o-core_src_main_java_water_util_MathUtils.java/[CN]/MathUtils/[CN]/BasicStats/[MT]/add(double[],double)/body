{
  double wsum=_wsum + w;
  for (int i=0; i < x.length; ++i) {
    double delta=x[i] - _mean[i];
    double R=delta * w / wsum;
    _mean[i]+=R;
    _m2[i]+=_wsum * delta * R;
  }
  _wsum=wsum;
  _nobs++;
}
