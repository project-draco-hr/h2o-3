{
  File f=new File(file);
  if (!f.exists())   throw new FileNotFoundException("File " + file + " cannot be found.");
  ContentReader cr=f.isDirectory() ? new FolderContentReader(file) : new ArchiveContentReader(file);
  Map<String,Object> info=parseModelInfo(cr);
  String[] columns=(String[])info.get("[columns]");
  String[][] domains=parseModelDomains(cr,columns.length,info.get("[domains]"));
  String algo=(String)info.get("algorithm");
  if (algo == null)   throw new IOException("Model file does not contain information about the model's algorithm.");
switch (algo) {
case "Distributed Random Forest":
    return new DrfModel(cr,info,columns,domains);
case "Gradient Boosting Method":
  return new GbmModel(cr,info,columns,domains);
default :
throw new IOException("Unsupported algorithm " + algo + " for raw models.");
}
}
