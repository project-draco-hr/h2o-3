{
switch (left.type()) {
case Val.NUM:
    final double dlf=left.getNum();
switch (rite.type()) {
case Val.NUM:
    return new ValNum(op(dlf,rite.getNum()));
case Val.FRM:
  return scalar_op_frame(dlf,rite.getFrame());
case Val.STR:
throw H2O.unimpl();
default :
throw H2O.fail();
}
case Val.FRM:
Frame flf=left.getFrame();
switch (rite.type()) {
case Val.NUM:
return frame_op_scalar(flf,rite.getNum());
case Val.STR:
return frame_op_scalar(flf,rite.getStr());
case Val.FRM:
return frame_op_frame(flf,rite.getFrame());
default :
throw H2O.fail();
}
case Val.STR:
String slf=left.getStr();
switch (rite.type()) {
case Val.NUM:
throw H2O.unimpl();
case Val.STR:
throw H2O.unimpl();
case Val.FRM:
return scalar_op_frame(slf,rite.getFrame());
default :
throw H2O.fail();
}
case Val.ROW:
double dslf[]=left.getRow();
switch (rite.type()) {
case Val.NUM:
double[] right=new double[dslf.length];
Arrays.fill(right,rite.getNum());
return row_op_row(dslf,right,((ValRow)left).getNames());
case Val.ROW:
return row_op_row(dslf,rite.getRow(),((ValRow)rite).getNames());
default :
throw H2O.fail();
}
default :
throw H2O.fail();
}
}
