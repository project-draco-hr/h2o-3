def add_schema_to_dependency_array(schema, known_schemas):
    '\n    Add a schema and (recursively) its fields to a list of the structs ordered by dependencies.\n    Does this by traversing depth first and appending along the way.\n    \n    Enums are added as well.\n    '
    global all_schemas_map
    for field in schema['fields']:
        if (None is field['schema_name']):
            continue
        field_schema_name = field['schema_name']
        if (field_schema_name in known_schemas):
            continue
        if field['type'].startswith('enum'):
            enum_name = field['schema_name']
            if (enum_name not in enums):
                enums[enum_name] = field['values']
                all_schemas_map[field_schema_name] = field
        if (field_schema_name not in all_schemas_map):
            raise Exception(('Failed to find the schema for field: ' + field_schema_name))
        field_schema = all_schemas_map[field_schema_name]
        if (not field_schema['type'].startswith('enum')):
            add_schema_to_dependency_array(field_schema, known_schemas)
        known_schemas.append(field_schema_name)
