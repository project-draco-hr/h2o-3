def _rtest_cmd(self, test_name, ip, port, on_hadoop, hadoop_namenode):
    if is_runit(test_name):
        r_test_driver = test_name
    else:
        r_test_driver = g_r_test_setup
    cmd = ['R', '-f', r_test_driver, '--args', '--usecloud', ((ip + ':') + str(port)), '--resultsDir', g_output_dir, '--testName', test_name]
    if is_runit(test_name):
        if on_hadoop:
            cmd = (cmd + ['--onHadoop'])
        if hadoop_namenode:
            cmd = (cmd + ['--hadoopNamenode', hadoop_namenode])
        cmd = (cmd + ['--rUnit'])
    elif (is_rdemo(test_name) and is_ipython_notebook(test_name)):
        cmd = (cmd + ['--rIPythonNotebook'])
    elif is_rdemo(test_name):
        cmd = (cmd + ['--rDemo'])
    elif is_rbooklet(test_name):
        cmd = (cmd + ['--rBooklet'])
    else:
        raise ValueError('Unsupported R test type: {1}'.format(test_name))
    return cmd
