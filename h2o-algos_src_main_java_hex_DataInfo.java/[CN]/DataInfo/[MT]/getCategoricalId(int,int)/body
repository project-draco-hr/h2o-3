{
  if (_catLvls != null) {
    int c=Arrays.binarySearch(_catLvls[cid],val);
    if (c >= 0)     return c + _catOffsets[cid];
  }
 else   if (_useAllFactorLevels)   return val + _catOffsets[cid];
  return val + _catOffsets[cid] - 1;
}
