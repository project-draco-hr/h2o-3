import h2o
cluster = h2o.H2OConnection()
df = h2o.H2OFrame(remote_fname='smalldata/logreg/prostate.csv')
del df['ID']
df['CAPSULE'] = df['CAPSULE'].asfactor()
vol = df['VOL']
vol[(vol == 0)] = None
r = vol.runif()
train = df[(r < 0.8)]
test = df[(r >= 0.8)]
print train.describe()
print test.describe()
dl = h2o.H2ODeepLearning(dataset=train, validation_dataset=test, x='CAPSULE', epochs=100, hidden=[20, 20, 20])
print dl.metrics()
