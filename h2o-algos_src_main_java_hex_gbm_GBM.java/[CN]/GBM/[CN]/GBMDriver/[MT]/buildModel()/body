{
  if (_parms._importance)   _improvPerVar=new float[_nclass];
  if (_parms._checkpoint) {
    Timer t=new Timer();
    new ResidualsCollector(_ncols,_nclass,_model._output._treeKeys).doAll(_train);
    Log.info("Reconstructing tree residuals stats from checkpointed model took " + t);
  }
  for (int tid=0; tid < _parms._requested_ntrees; tid++) {
    if (tid != 0 || !_parms._checkpoint)     doScoringAndSaveModel(false,false,false);
    new ComputeProb().doAll(_train);
    new ComputeRes().doAll(_train);
    Timer kb_timer=new Timer();
    buildNextKTrees();
    Log.info((tid + 1) + ". tree was built in " + kb_timer.toString());
    if (!isRunning())     return;
  }
  doScoringAndSaveModel(true,false,false);
}
