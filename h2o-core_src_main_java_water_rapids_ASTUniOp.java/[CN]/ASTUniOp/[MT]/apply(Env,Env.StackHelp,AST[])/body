{
  Val val=stk.track(asts[1].exec(env));
switch (val.type()) {
case Val.NUM:
    return new ValNum(op(val.getNum()));
case Val.FRM:
  Frame fr=val.getFrame();
return new ValFrame(new MRTask(){
  @Override public void map(  Chunk cs[],  NewChunk ncs[]){
    for (int col=0; col < cs.length; col++) {
      Chunk c=cs[col];
      NewChunk nc=ncs[col];
      for (int i=0; i < c._len; i++)       nc.addNum(op(c.atd(i)));
    }
  }
}
.doAll(fr.numCols(),Vec.T_NUM,fr).outputFrame());
case Val.ROW:
ValRow v=(ValRow)val;
double[] ds=new double[v._ds.length];
for (int i=0; i < ds.length; ++i) ds[i]=op(v._ds[i]);
String[] names=v._names.clone();
return new ValRow(ds,names);
default :
throw H2O.unimpl("unop unimpl: " + val.getClass());
}
}
