{
  x.mu=linkInv(eta + off);
  double var=Math.max(1e-6,variance(x.mu));
  double d=linkDeriv(x.mu);
  x.w=w / (var * d * d);
  x.z=eta + (y - x.mu) * d;
  x.l=w * likelihood(y,x.mu);
  x.dev=w * deviance(y,x.mu);
  return x;
}
