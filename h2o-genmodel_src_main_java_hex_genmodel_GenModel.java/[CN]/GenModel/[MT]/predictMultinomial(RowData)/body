{
  if (getModelCategory() != ModelCategory.Multinomial) {
    throw new PredictWrongModelCategoryException("Prediction type unsupported by model of category " + getModelCategory());
  }
  double[] preds=new double[getPredsSize()];
  preds=predict(data,preds);
  MultinomialModelPrediction p=new MultinomialModelPrediction();
  p.classProbabilities=new double[getNumResponseClasses()];
  p.labelIndex=(int)preds[0];
  String[] domainValues=getDomainValues(getResponseIdx());
  p.label=domainValues[p.labelIndex];
  for (int i=0; i < p.classProbabilities.length; i++) {
    p.classProbabilities[i]=preds[i + 1];
  }
  return p;
}
