{
  System.out.println("Create modelParameter object with testcase: " + input[tcHeaders.indexOf(testcase_id)]);
  Model.Parameters modelParameter=null;
switch (algorithm) {
case FunctionUtils.drf:
    modelParameter=new DRFModel.DRFParameters();
  Family drfFamily=(Family)DRFConfig.familyParams.getValue(input,tcHeaders);
if (drfFamily != null) {
  System.out.println("Set _distribution: " + drfFamily);
  modelParameter._distribution=drfFamily;
}
break;
case FunctionUtils.glm:
modelParameter=new GLMParameters();
hex.glm.GLMModel.GLMParameters.Family glmFamily=(hex.glm.GLMModel.GLMParameters.Family)GLMConfig.familyOptionsParams.getValue(input,tcHeaders);
Solver s=(Solver)GLMConfig.solverOptionsParams.getValue(input,tcHeaders);
if (glmFamily != null) {
System.out.println("Set _family: " + glmFamily);
((GLMParameters)modelParameter)._family=glmFamily;
}
if (s != null) {
System.out.println("Set _solver: " + s);
((GLMParameters)modelParameter)._solver=s;
}
break;
case FunctionUtils.gbm:
modelParameter=new GBMParameters();
Family gbmFamily=(Family)GBMConfig.familyParams.getValue(input,tcHeaders);
if (gbmFamily != null) {
System.out.println("Set _distribution: " + gbmFamily);
modelParameter._distribution=gbmFamily;
}
break;
default :
System.out.println("can not parse to object parameter with algorithm: " + algorithm);
}
Param.setAutoSetParams(modelParameter,params,tcHeaders,input);
modelParameter._response_column=train_dataset.getResponseColumn();
Frame trainFrame=null;
Frame validateFrame=null;
Frame betaConstraints=null;
try {
System.out.println("Create train frame: " + train_dataset_id);
trainFrame=train_dataset.getFrame();
if (StringUtils.isNotEmpty(train_dataset_id) && validate_dataset != null && validate_dataset.isAvailabel()) {
System.out.println("Create validate frame: " + train_dataset_id);
validateFrame=validate_dataset.getFrame();
}
if (algorithm.equals(FunctionUtils.glm)) {
betaConstraints=createBetaConstraints(tcHeaders,input,trainFrame,train_dataset.getResponseColumn());
if (betaConstraints != null) {
((GLMParameters)modelParameter)._beta_constraints=betaConstraints._key;
}
}
}
 catch (Exception e) {
if (trainFrame != null) {
trainFrame.remove();
}
if (validateFrame != null) {
validateFrame.remove();
}
if (betaConstraints != null) {
betaConstraints.remove();
}
throw e;
}
System.out.println("Set train frame");
modelParameter._train=trainFrame._key;
if (validateFrame != null) {
System.out.println("Set validate frame");
modelParameter._valid=validateFrame._key;
}
System.out.println("Create success DRFParameters object.");
return modelParameter;
}
