{
  Reporter.log("Create modelParameter object with testcase: " + rawInput.get(CommonHeaders.testcase_id),true);
  Model.Parameters modelParameter=null;
switch (algorithm) {
case FunctionUtils.drf:
    modelParameter=new DRFModel.DRFParameters();
  Family drfFamily=(Family)DRFConfig.familyParams.getValue(rawInput);
if (drfFamily != null) {
  Reporter.log("Set _distribution: " + drfFamily);
  modelParameter._distribution=drfFamily;
}
break;
case FunctionUtils.glm:
modelParameter=new GLMParameters();
Solver s=(Solver)GLMConfig.solverOptionsParams.getValue(rawInput);
hex.glm.GLMModel.GLMParameters.Family glmFamily=(hex.glm.GLMModel.GLMParameters.Family)GLMConfig.familyOptionsParams.getValue(rawInput);
if (s != null) {
Reporter.log("Set _solver: " + s);
((GLMParameters)modelParameter)._solver=s;
}
if (glmFamily != null) {
Reporter.log("Set _family: " + glmFamily);
((GLMParameters)modelParameter)._family=glmFamily;
}
break;
case FunctionUtils.gbm:
modelParameter=new GBMParameters();
Family gbmFamily=(Family)GBMConfig.familyParams.getValue(rawInput);
if (gbmFamily != null) {
Reporter.log("Set _distribution: " + gbmFamily);
modelParameter._distribution=gbmFamily;
}
break;
default :
Reporter.log("Can not parse to object parameter with algorithm: " + algorithm,true);
}
Param.setAutoSetParams(modelParameter,params,rawInput);
modelParameter._response_column=train_dataset.getResponseColumn();
Frame trainFrame=null;
Frame validateFrame=null;
Frame betaConstraints=null;
try {
Reporter.log("Create train frame: " + train_dataset_id,true);
trainFrame=train_dataset.getFrame();
if (StringUtils.isNotEmpty(train_dataset_id) && validate_dataset != null && validate_dataset.isAvailabel()) {
Reporter.log("Create validate frame: " + train_dataset_id,true);
validateFrame=validate_dataset.getFrame();
}
if (algorithm.equals(FunctionUtils.glm)) {
betaConstraints=createBetaConstraints(rawInput,trainFrame,train_dataset.getResponseColumn());
if (betaConstraints != null) {
((GLMParameters)modelParameter)._beta_constraints=betaConstraints._key;
}
}
}
 catch (Exception e) {
if (trainFrame != null) {
trainFrame.remove();
}
if (validateFrame != null) {
validateFrame.remove();
}
if (betaConstraints != null) {
betaConstraints.remove();
}
throw e;
}
Reporter.log("Set train frame");
modelParameter._train=trainFrame._key;
if (validateFrame != null) {
Reporter.log("Set validate frame");
modelParameter._valid=validateFrame._key;
}
Reporter.log("Create success DRFParameters object.",true);
return modelParameter;
}
