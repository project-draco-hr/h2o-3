{
  System.out.println("Create modelParameter object with testcase: " + rawInput.get(CommonHeaders.testcase_id));
  boolean isTunedValue=false;
  Model.Parameters modelParameter=null;
switch (algorithm) {
case FunctionUtils.drf:
    modelParameter=new DRFModel.DRFParameters();
  Family drfFamily=(Family)DRFConfig.familyParams.getValue(rawInput);
if (drfFamily != null) {
  System.out.println("Set _distribution: " + drfFamily);
  modelParameter._distribution=drfFamily;
  isTunedValue=true;
}
break;
case FunctionUtils.glm:
modelParameter=new GLMParameters();
hex.glm.GLMModel.GLMParameters.Family glmFamily=(hex.glm.GLMModel.GLMParameters.Family)GLMConfig.familyOptionsParams.getValue(rawInput);
Solver s=(Solver)GLMConfig.solverOptionsParams.getValue(rawInput);
if (glmFamily != null) {
System.out.println("Set _family: " + glmFamily);
((GLMParameters)modelParameter)._family=glmFamily;
isTunedValue=true;
}
if (s != null) {
System.out.println("Set _solver: " + s);
((GLMParameters)modelParameter)._solver=s;
isTunedValue=true;
}
break;
case FunctionUtils.gbm:
modelParameter=new GBMParameters();
Family gbmFamily=(Family)GBMConfig.familyParams.getValue(rawInput);
if (gbmFamily != null) {
System.out.println("Set _distribution: " + gbmFamily);
modelParameter._distribution=gbmFamily;
isTunedValue=true;
}
break;
case FunctionUtils.dl:
modelParameter=new DeepLearningParameters();
Family dlDistribution=(Family)DeepLearningConfig.distributionOptionsParams.getValue(rawInput);
if (dlDistribution != null) {
System.out.println("Set _distribution: " + dlDistribution);
modelParameter._distribution=dlDistribution;
isTunedValue=true;
}
DeepLearningParameters.Activation dlActivation=(DeepLearningParameters.Activation)DeepLearningConfig.activationOptionsParams.getValue(rawInput);
if (dlActivation != null) {
System.out.println("Set _activation: " + dlActivation);
((DeepLearningParameters)modelParameter)._activation=dlActivation;
isTunedValue=true;
}
DeepLearningParameters.Loss dlLoss=(DeepLearningParameters.Loss)DeepLearningConfig.lossOptionsParams.getValue(rawInput);
if (dlLoss != null) {
System.out.println("Set _activation: " + dlLoss);
((DeepLearningParameters)modelParameter)._loss=dlLoss;
}
DeepLearningParameters.InitialWeightDistribution dlInitialWeightDistribution=(DeepLearningParameters.InitialWeightDistribution)DeepLearningConfig.initialWeightDistributionOptionsParams.getValueKey(rawInput,"_initial_weight_distribution");
if (dlInitialWeightDistribution != null) {
System.out.println("Set _initial_weight_distribution: " + dlInitialWeightDistribution);
((DeepLearningParameters)modelParameter)._initial_weight_distribution=dlInitialWeightDistribution;
isTunedValue=true;
}
DeepLearningParameters.MissingValuesHandling dlMissingValuesHandling=(DeepLearningParameters.MissingValuesHandling)DeepLearningConfig.missingValuesHandlingOptionsParams.getValueKey(rawInput,"_missing_values_handling");
if (dlMissingValuesHandling != null) {
System.out.println("Set _missing_values_handling: " + dlMissingValuesHandling);
((DeepLearningParameters)modelParameter)._missing_values_handling=dlMissingValuesHandling;
isTunedValue=true;
}
break;
default :
System.out.println("can not parse to object parameter with algorithm: " + algorithm);
}
isTunedValue|=Param.setAutoSetParams(modelParameter,params,rawInput);
if (isTunedValue) {
rawInput.put(MySQL.tuned_or_defaults,MySQL.tuned);
}
 else {
rawInput.put(MySQL.tuned_or_defaults,MySQL.defaults);
}
modelParameter._response_column=train_dataset.getResponseColumn();
Frame trainFrame=null;
Frame validateFrame=null;
Frame betaConstraints=null;
try {
System.out.println("Create train frame: " + train_dataset_id);
trainFrame=train_dataset.getFrame();
if (StringUtils.isNotEmpty(validate_dataset_id) && validate_dataset != null && validate_dataset.isAvailabel()) {
System.out.println("Create validate frame: " + validate_dataset_id);
validateFrame=validate_dataset.getFrame();
}
if (algorithm.equals(FunctionUtils.glm)) {
betaConstraints=createBetaConstraints(rawInput,trainFrame,train_dataset.getResponseColumn());
if (betaConstraints != null) {
((GLMParameters)modelParameter)._beta_constraints=betaConstraints._key;
}
}
}
 catch (Exception e) {
if (trainFrame != null) {
trainFrame.remove();
}
if (validateFrame != null) {
validateFrame.remove();
}
if (betaConstraints != null) {
betaConstraints.remove();
}
throw e;
}
System.out.println("Set train frame");
modelParameter._train=trainFrame._key;
if (validateFrame != null) {
System.out.println("Set validate frame");
modelParameter._valid=validateFrame._key;
}
System.out.println("Create success modelParameter object.");
return modelParameter;
}
