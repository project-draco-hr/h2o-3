{
  super(Key.make("GridSearch_" + modelName() + Key.rand()),gkey,modelName() + " Grid Search");
  _hyperSearch=hyperSearch;
  for (int i=0; i < _hyperSearch.length; i++)   if (_hyperSearch[i] == null)   _hyperSearch[i]=new double[]{hyperDefault(i)};
  int work=1;
  for (  double hparms[] : _hyperSearch)   work*=hparms.length;
  _total_models=work;
  double[] hypers=new double[nHyperParms()];
  for (int[] hidx=new int[nHyperParms()]; hidx != null; hidx=nextModel(hidx)) {
    ModelBuilder mb=getBuilder(hypers(hidx,hypers));
    mb.init(false);
    if (mb.error_count() > 0)     throw new IllegalArgumentException(mb.validationErrors());
  }
}
