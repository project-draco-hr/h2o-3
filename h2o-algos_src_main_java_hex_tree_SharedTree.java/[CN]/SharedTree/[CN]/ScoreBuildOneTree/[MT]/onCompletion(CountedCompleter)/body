{
  ScoreBuildHistogram sbh=(ScoreBuildHistogram)caller;
  final int leafk=_leafs[_k];
  int tmax=_tree.len();
  for (int leaf=leafk; leaf < tmax; leaf++) {
    DTree.UndecidedNode udn=_tree.undecided(leaf);
    DTree.DecidedNode dn=_st.makeDecided(udn,sbh._hcs[leaf - leafk]);
    if (dn._split == null)     udn.do_not_split();
 else {
      _did_split=true;
      DTree.Split s=dn._split;
      assert((float)(s.pre_split_se() - s.se()) >= 0);
      AtomicUtils.FloatArray.add(_improvPerVar,s.col(),(float)(s.pre_split_se() - s.se()));
    }
  }
  _leafs[_k]=tmax;
  int new_leafs=_tree.len() - tmax;
  _hcs[_k]=new DHistogram[new_leafs][];
  for (int nl=tmax; nl < _tree.len(); nl++)   _hcs[_k][nl - tmax]=_tree.undecided(nl)._hs;
  if (_did_split)   _tree._depth++;
}
