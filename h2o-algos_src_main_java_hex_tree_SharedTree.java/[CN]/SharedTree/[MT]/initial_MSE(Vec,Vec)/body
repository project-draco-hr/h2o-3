{
  if (train.isCategorical()) {
    int cls=ArrayUtils.maxIndex(train.bins());
    double guess=train.bins()[cls] / (train.length() - train.naCnt());
    double actual=test.bins()[cls] / (test.length() - test.naCnt());
    return guess * guess + actual - 2.0 * actual * guess;
  }
 else {
    double stddev=test.sigma();
    double bias=train.mean() - test.mean();
    return stddev * stddev + bias * bias;
  }
}
