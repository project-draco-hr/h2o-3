{
  double sumsqr=0, sum=0;
  long nobs=0;
  int ncols=dinfo._adaptedFrame.numCols();
  for (int r=0; r < cs[0].len(); r++) {
    DataInfo.Row row=dinfo.newDenseRow();
    if (dinfo.extractDenseRow(cs,r,row).bad)     continue;
    sum=row.innerProduct(vec);
    sumsqr+=sum * sum;
    nobs++;
    chk_u(cs,k,ncols).set(r,sum);
  }
  result._sumsqr=sumsqr;
  result._nobs=nobs;
  return result;
}
