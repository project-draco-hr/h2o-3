{
  long start_time=System.currentTimeMillis();
  Frame adaptFr=new Frame(fr);
  Vec sresp=_output.isClassifier() ? fr.vec(_output.responseName()) : null;
  adaptTestForTrain(adaptFr,true);
  Frame output=scoreImpl(fr,adaptFr);
  Vec mresp=output.vecs()[0];
  String mdomain[]=mresp.domain();
  ConfusionMatrix2 cm=ModelMetrics.getFromDKV(this,fr)._cm;
  if (cm._arr.length < 20)   water.util.Log.info(water.util.PrettyPrint.printConfusionMatrix(new StringBuilder(),cm._arr,mdomain,false));
  if (_output.isClassifier()) {
    String sdomain[]=sresp.domain();
    if (mdomain != sdomain && !Arrays.equals(mdomain,sdomain))     output.replace(0,new TransfVec(sresp.group().addVec(),sresp.get_espc(),sdomain,mresp._key));
  }
  Vec[] vecs=adaptFr.vecs();
  for (int i=0; i < vecs.length; i++)   if (fr.find(vecs[i]) != -1)   vecs[i]=null;
  adaptFr.delete();
  return output;
}
