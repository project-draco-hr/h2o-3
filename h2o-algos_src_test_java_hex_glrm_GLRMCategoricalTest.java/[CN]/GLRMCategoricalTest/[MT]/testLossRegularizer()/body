{
  long seed=0xDECAF;
  Random rng=new Random(seed);
  Frame train=null;
  final int[] cats=new int[]{1,3,4,5};
  final GLRMModel.GLRMParameters.Regularizer[] regs=new GLRMModel.GLRMParameters.Regularizer[]{GLRMModel.GLRMParameters.Regularizer.L2,GLRMModel.GLRMParameters.Regularizer.L1,GLRMModel.GLRMParameters.Regularizer.NonNegative,GLRMModel.GLRMParameters.Regularizer.OneSparse,GLRMModel.GLRMParameters.Regularizer.UnitOneSparse,GLRMModel.GLRMParameters.Regularizer.Simplex};
  Scope.enter();
  try {
    train=parse_test_file(Key.make("prostate.hex"),"smalldata/logreg/prostate.csv");
    for (int i=0; i < cats.length; i++)     Scope.track(train.replace(cats[i],train.vec(cats[i]).toEnum())._key);
    train.remove("ID").remove();
    DKV.put(train._key,train);
    for (    GLRMModel.GLRMParameters.Loss loss : new GLRMModel.GLRMParameters.Loss[]{GLRMModel.GLRMParameters.Loss.L2,GLRMModel.GLRMParameters.Loss.L1,GLRMModel.GLRMParameters.Loss.Huber,GLRMModel.GLRMParameters.Loss.Poisson,GLRMModel.GLRMParameters.Loss.Hinge,GLRMModel.GLRMParameters.Loss.Logistic}) {
      for (      GLRMModel.GLRMParameters.MultiLoss multiloss : new GLRMModel.GLRMParameters.MultiLoss[]{GLRMModel.GLRMParameters.MultiLoss.Categorical,GLRMModel.GLRMParameters.MultiLoss.Ordinal}) {
        GLRMModel model=null;
        try {
          Scope.enter();
          long myseed=rng.nextLong();
          Log.info("GLRM using seed = " + myseed);
          GLRMModel.GLRMParameters parms=new GLRMModel.GLRMParameters();
          parms._train=train._key;
          parms._transform=DataInfo.TransformType.NONE;
          parms._k=5;
          parms._loss=loss;
          parms._multi_loss=multiloss;
          parms._init=GLRM.Initialization.SVD;
          parms._regularization_x=regs[rng.nextInt(regs.length)];
          parms._regularization_y=regs[rng.nextInt(regs.length)];
          parms._gamma_x=Math.abs(rng.nextDouble());
          parms._gamma_y=Math.abs(rng.nextDouble());
          parms._recover_svd=false;
          parms._seed=myseed;
          parms._verbose=false;
          GLRM job=new GLRM(parms);
          try {
            model=job.trainModel().get();
            Log.info("Iteration " + model._output._iterations + ": Objective value = "+ model._output._objective);
          }
 catch (          Throwable t) {
            throw t;
          }
 finally {
            job.remove();
          }
        }
 catch (        Throwable t) {
          t.printStackTrace();
          throw new RuntimeException(t);
        }
 finally {
          if (model != null) {
            model._output._loading_key.get().delete();
            model.delete();
          }
          Scope.exit();
        }
      }
    }
  }
  finally {
    if (train != null)     train.delete();
    Scope.exit();
  }
}
