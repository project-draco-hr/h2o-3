{
  cluster_init();
  HashSet<Key> locked=new HashSet<>();
  Env env=Env.make(locked);
  try {
    Exec ex=new Exec(str,env);
    AST ast=ex.parse();
    if (ex.skipWS().hasNext())     throwErr("Note that only a single statement can be processed at a time. Junk at the end of the statement: ",ex);
    env=ast.treeWalk(env);
    env.postWrite();
  }
 catch (  RuntimeException t) {
    env.remove_and_unlock();
    throw t;
  }
  return env;
}
