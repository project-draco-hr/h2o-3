{
  double[][] iris=ard(ard(6.3,2.5,4.9,1.5,1),ard(5.7,2.8,4.5,1.3,1),ard(5.6,2.8,4.9,2.0,2),ard(5.0,3.4,1.6,0.4,0),ard(6.0,2.2,5.0,1.5,2));
  double[][] iris_expandR=ard(ard(6.3,2.5,4.9,1.5,0,1,0),ard(5.7,2.8,4.5,1.3,0,1,0),ard(5.6,2.8,4.9,2.0,0,0,1),ard(5.0,3.4,1.6,0.4,1,0,0),ard(6.0,2.2,5.0,1.5,0,0,1));
  String[] iris_cols=new String[]{"sepal_len","sepal_wid","petal_len","petal_wid","class"};
  String[][] iris_domains=new String[][]{null,null,null,null,new String[]{"setosa","versicolor","virginica"}};
  double[][] iris_expand=GLRM.expandCategoricals(iris,iris_domains);
  Log.info("Original matrix:\n" + colFormat(iris_cols," %7.7s") + ArrayUtils.pprint(iris));
  Log.info("Expanded matrix:\n" + colExpFormat(iris_cols,iris_domains," %7.7s") + ArrayUtils.pprint(iris_expand));
  Assert.assertArrayEquals(iris_expandR,iris_expand);
  double[][] prostate=ard(ard(1,75,0,0,4.8,26.3,1,7),ard(0,67,0,2,18.1,0.0,1,8),ard(0,54,1,0,64.3,0.0,1,7),ard(0,76,0,0,7.6,3.7,1,6));
  double[][] pros_expandR=ard(ard(0,1,75,1,0,1,0,0,0,4.8,26.3,0,1,7),ard(1,0,67,1,0,0,0,1,0,18.1,0.0,0,1,8),ard(1,0,54,0,1,1,0,0,0,64.3,0.0,0,1,7),ard(1,0,76,1,0,1,0,0,0,7.6,3.7,0,1,6));
  String[] pros_cols=new String[]{"Capsule","Age","Race","Dpros","PSA","Vol","Dcaps","Gleason"};
  String[][] pros_domains=new String[][]{new String[]{"No","Yes"},null,new String[]{"White","Black"},new String[]{"None","UniLeft","UniRight","Bilobar"},null,null,new String[]{"No","Yes"},null};
  double[][] pros_expand=GLRM.expandCategoricals(prostate,pros_domains);
  Log.info("\nOriginal matrix:\n" + colFormat(pros_cols," %7.7s") + ArrayUtils.pprint(prostate));
  Log.info("Expanded matrix:\n" + colExpFormat(pros_cols,pros_domains," %7.7s") + ArrayUtils.pprint(pros_expand));
  Assert.assertArrayEquals(pros_expandR,pros_expand);
}
