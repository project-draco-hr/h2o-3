{
  Quantiles q=s.createAndFillImpl();
  init(q);
  String[] names=new String[1];
  boolean multiPass;
  Quantiles[] qbins;
  double[] quantiles_to_do=new double[1];
  quantiles_to_do[0]=q._quantile;
  double approxResult;
  double exactResult;
  q._result_single=Double.NaN;
  q._result=Double.NaN;
  boolean done=false;
  qbins=null;
  if (q._multiple_pass == 0 || q._multiple_pass == 2) {
    multiPass=false;
    q._result_single=Double.NaN;
    if (q._multiple_pass == 0)     q._result=Double.NaN;
    double valStart=q._column.min();
    double valEnd=q._column.max();
    qbins=new Quantiles.BinningTask(q._max_qbins,valStart,valEnd).doAll(q._column)._qbins;
    Log.debug("Q_ for approx. valStart: " + valStart + " valEnd: "+ valEnd);
    q._interpolation_type_used=q._interpolation_type;
    q._quantile_requested=quantiles_to_do[0];
    if (qbins != null) {
      qbins[0].finishUp(q._column,quantiles_to_do,q._interpolation_type,multiPass);
      q._column_name=names[0];
      q._iterations=1;
      done=qbins[0]._done;
      approxResult=qbins[0]._pctile[0];
      q._interpolated=qbins[0]._interpolated;
    }
 else {
      q._column_name="";
      q._iterations=0;
      done=false;
      approxResult=Double.NaN;
      q._interpolated=false;
    }
    q._result_single=approxResult;
    if (q._multiple_pass == 0)     q._result=approxResult;
  }
  if (q._multiple_pass == 1 || q._multiple_pass == 2) {
    final int MAX_ITERATIONS=16;
    multiPass=true;
    exactResult=Double.NaN;
    double valStart=q._column.min();
    double valEnd=q._column.max();
    for (int b=0; b < MAX_ITERATIONS; b++) {
      if (!(q._multiple_pass == 2 && b == 0)) {
        qbins=new Quantiles.BinningTask(q._max_qbins,valStart,valEnd).doAll(q._column)._qbins;
      }
      q._iterations=b + 1;
      if (qbins == null)       break;
 else {
        qbins[0].finishUp(q._column,quantiles_to_do,q._interpolation_type,multiPass);
        Log.debug("\nQ_ multipass iteration: " + q._iterations + " valStart: "+ valStart+ " valEnd: "+ valEnd);
        double valBinSize=qbins[0]._valBinSize;
        Log.debug("Q_ valBinSize: " + valBinSize);
        valStart=qbins[0]._newValStart;
        valEnd=qbins[0]._newValEnd;
        done=qbins[0]._done;
        if (done)         break;
      }
    }
    q._interpolation_type_used=q._interpolation_type;
    q._quantile_requested=quantiles_to_do[0];
    if (qbins != null) {
      q._column_name=names[0];
      done=qbins[0]._done;
      exactResult=qbins[0]._pctile[0];
      q._interpolated=qbins[0]._interpolated;
    }
 else {
      q._column_name="";
      q._iterations=0;
      done=false;
      exactResult=Double.NaN;
      q._interpolated=false;
    }
    qbins=null;
    q._result=exactResult;
  }
  return s.fillFromImpl(q);
}
