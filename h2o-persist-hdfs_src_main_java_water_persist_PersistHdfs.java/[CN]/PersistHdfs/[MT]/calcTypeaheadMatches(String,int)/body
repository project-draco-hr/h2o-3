{
  Configuration conf=PersistHdfs.CONF;
  if (S3N_BARE_BUCKET.matcher(filter).matches()) {
    filter+="/";
  }
  ArrayList<String> array=new ArrayList<String>();
  try {
    Path p=new Path(filter);
    Path expand=p;
    if (!filter.endsWith("/"))     expand=p.getParent();
    FileSystem fs=FileSystem.get(p.toUri(),conf);
    for (    FileStatus file : fs.listStatus(expand)) {
      Path fp=file.getPath();
      if (fp.toString().startsWith(p.toString())) {
        array.add(fp.toString());
      }
      if (array.size() == limit)       break;
    }
  }
 catch (  Throwable xe) {
    xe.printStackTrace();
    Log.debug(xe);
  }
  return array;
}
