def _write_python_data_to_file_and_upload(self, header, data_to_write):
    tmp_file_path = tempfile.mkstemp(suffix='.csv')[1]
    tmp_file = open(tmp_file_path, 'wb')
    csv_writer = csv.DictWriter(tmp_file, fieldnames=header, restval=None, dialect='excel', extrasaction='ignore', delimiter=',')
    csv_writer.writeheader()
    csv_writer.writerows(data_to_write)
    tmp_file.close()
    self._upload_raw_data(tmp_file_path, header)
