from __future__ import print_function
import h2o
h2o.init(strict_version_check=False)
h2o.shutdown(prompt=False)
h2o.init(strict_version_check=False)
conn = h2o.H2OConnection(ip='localhost', port=54321, start_h2o=True)
cluster_up = conn.cluster_is_up(conn)
conn.json = h2o.H2OConnection.get_json('Cloud?skip_ticks=true')
nodes = conn.json['nodes']
nodes = nodes[0]
cluster_health = nodes['healthy']
if (cluster_health == (True & cluster_up) == True):
    print('Cluster health is up and healthy')
elif (cluster_health != (True & cluster_up) == True):
    raise ValueError('Cluster is up but not healthy')
else:
    raise ValueError('Cluster is not up and is not healthy')
