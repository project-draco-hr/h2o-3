{
switch (regularization) {
case L2:
    return 2 * u;
case L1:
  return u == 0 ? 0 : (u > 0 ? 1 : -1);
default :
throw new RuntimeException("Unknown regularization function " + regularization);
}
}
