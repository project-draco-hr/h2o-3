{
switch (_loss) {
case L2:
    return 2 * (u - a);
case L1:
  return -Math.signum(u - a);
case Huber:
return Math.abs(u - a) <= 1 ? u - a : Math.signum(u - a);
case Poisson:
return Math.exp(u) - a;
case Hinge:
return a * u <= 1 ? -a : 0;
case Logistic:
return -a / (1 + Math.exp(a * u));
default :
throw new RuntimeException("Unknown loss function " + _loss);
}
}
