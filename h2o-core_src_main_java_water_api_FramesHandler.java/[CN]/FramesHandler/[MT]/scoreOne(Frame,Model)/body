{
  ModelMetrics metrics=ModelMetrics.getFromDKV(score_model,frame);
  if (null == metrics) {
    water.util.Log.debug("Cache miss: computing ModelMetrics. . .");
    long before=System.currentTimeMillis();
    Frame predictions=score_model.score(frame,true);
    long after=System.currentTimeMillis();
    ConfusionMatrix cm=new ConfusionMatrix();
    AUC auc=null;
    HitRatio hr=null;
    if (score_model._output.getModelCategory() == Model.ModelCategory.Binomial || score_model._output.getModelCategory() == Model.ModelCategory.Multinomial) {
      SupervisedModel sm=(SupervisedModel)score_model;
      auc=new AUC();
      sm.calcError(frame,frame.vec(score_model._output.responseName()),predictions,predictions,"Prediction error:",true,20,cm,auc,hr);
    }
 else     if (score_model._output.getModelCategory() == Model.ModelCategory.Regression) {
      SupervisedModel sm=(SupervisedModel)score_model;
      sm.calcError(frame,frame.vec(score_model._output.responseName()),predictions,predictions,"Prediction error:",true,20,cm,null,null);
    }
 else {
    }
    metrics=new ModelMetrics(score_model,score_model._output.getModelCategory(),frame,after - before,after,(auc == null ? null : auc.data()),cm);
    metrics.putInDKV();
  }
 else {
    water.util.Log.debug("using ModelMetrics from the cache. . .");
  }
  return metrics;
}
