double[] res
double[] x
double[] y
double w
