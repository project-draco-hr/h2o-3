{
  final float pa=(float)localmodel.get_params()._elastic_averaging_moving_rate;
  assert(pa > 0 && pa <= 1);
  DeepLearningModelInfo elasticaverage=DKV.getGet(localmodel.elasticAverageModelInfoKey());
  if (pa == 1) {
    elasticaverage=localmodel.deep_clone();
  }
 else {
    localmodel.mult(pa);
    elasticaverage.mult(1 - pa);
    elasticaverage.add(localmodel);
    elasticaverage.set_processed_global(localmodel.get_processed_global());
  }
  elasticaverage.set_processed_local(0);
  DKV.put(elasticaverage.elasticAverageModelInfoKey(),elasticaverage);
  return elasticaverage;
}
