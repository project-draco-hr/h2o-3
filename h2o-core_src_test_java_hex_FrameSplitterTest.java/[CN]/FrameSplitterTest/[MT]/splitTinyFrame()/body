{
  Frame dataset=null;
  double[] ratios=ard(0.5f);
  Frame[] splits=null;
  try {
    dataset=ArrayUtils.frame(ar("COL1"),ear(0,1,2,3,4,5,6,7,8,9));
    FrameSplitter fs=new FrameSplitter(dataset,ratios,generateNumKeys(dataset._key,ratios.length + 1),null);
    H2O.submitTask(fs).join();
    splits=fs.getResult();
    Assert.assertEquals("The expected number of split frames is ratios.length+1",ratios.length + 1,splits.length);
    for (    Frame f : splits)     Assert.assertEquals("The expected number of rows in partition.",5,f.numRows());
  }
  finally {
    if (dataset != null)     dataset.delete();
    if (splits != null)     for (    Frame sf : splits)     if (sf != null)     sf.delete();
  }
}
