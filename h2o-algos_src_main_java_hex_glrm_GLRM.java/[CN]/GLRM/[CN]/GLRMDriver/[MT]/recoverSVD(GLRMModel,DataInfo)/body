{
  GramTask xgram=new GramTask(self(),xinfo).doAll(xinfo._adaptedFrame);
  Cholesky xxchol=regularizedCholesky(xgram._gram);
  Matrix x_r=new Matrix(xxchol.getL()).transpose();
  x_r=x_r.times(Math.sqrt(_train.numRows()));
  Matrix yt=new Matrix(model._output._archetypes_raw.getY(true));
  QRDecomposition yt_qr=new QRDecomposition(yt);
  Matrix yt_r=yt_qr.getR();
  Matrix rrmul=x_r.times(yt_r.transpose());
  SingularValueDecomposition rrsvd=new SingularValueDecomposition(rrmul);
  Matrix eigvec=yt_qr.getQ().times(rrsvd.getV());
  model._output._eigenvectors=eigvec.getArray();
  model._output._singular_vals=rrsvd.getSingularValues();
}
