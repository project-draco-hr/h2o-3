{
  if (x == null)   return null;
  int ncol=x[0].length;
  double[][] xgram=new double[ncol][ncol];
  for (int i=0; i < x.length; i++) {
    for (int j=0; j < ncol; j++) {
      for (int k=j; k < ncol; k++)       xgram[j][k]+=x[i][j] * x[i][k];
    }
  }
  for (int i=0; i < x.length; i++) {
    for (int j=0; j < ncol; j++) {
      for (int k=0; k < j; k++)       xgram[j][k]=xgram[k][j];
    }
  }
  return xgram;
}
