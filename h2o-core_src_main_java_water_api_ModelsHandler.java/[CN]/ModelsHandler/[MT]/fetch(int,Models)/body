{
  Model model=getFromDKV(m.key);
  m.models=new Model[1];
  m.models[0]=model;
  ModelsBase schema=this.schema(version).fillFromImpl(m);
  if (m.find_compatible_frames) {
    Frame[] compatible=Models.findCompatibleFrames(model,Frames.fetchAll(),m.fetchFrameCols());
    schema.compatible_frames=new FrameV2[compatible.length];
    schema.models[0].compatible_frames=new String[compatible.length];
    int i=0;
    for (    Frame f : compatible) {
      schema.compatible_frames[i]=new FrameV2(f).fillFromImpl(f);
      schema.models[0].compatible_frames[i]=f._key.toString();
      i++;
    }
  }
  return schema;
}
